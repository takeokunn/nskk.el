# NSKK Beta Testing Guide

## 目次

1. [テスト環境のセットアップ](#テスト環境のセットアップ)
2. [基本機能テスト](#基本機能テスト)
3. [AI機能テスト](#ai機能テスト)
4. [同期機能テスト](#同期機能テスト)
5. [パフォーマンステスト](#パフォーマンステスト)
6. [プラグインテスト](#プラグインテスト)
7. [フィードバックの提出](#フィードバックの提出)

## テスト環境のセットアップ

### 前提条件

- Emacs 31.0以降
- Git
- 最低2GBの空きメモリ
- インターネット接続 (同期機能テスト用)

### インストール手順

```bash
# 1. リポジトリをクローン
cd ~/.emacs.d/
git clone https://github.com/takeokunn/nskk.el.git
cd nskk.el
git checkout v0.9.0-beta

# 2. テスト用辞書のダウンロード (オプション)
# SKK-JISYOファイルを配置
```

### 初期設定

```elisp
;; ~/.emacs.d/init.el に追加

(add-to-list 'load-path "~/.emacs.d/nskk.el")
(require 'nskk)

;; 基本設定
(setopt nskk-dictionary "~/.skk-jisyo")
(setopt nskk-large-dictionary "/path/to/SKK-JISYO.L")

;; テスト用設定
(setopt nskk-debug-mode t)  ; デバッグモード有効化
(setopt nskk-log-level 'debug)  ; 詳細ログ

;; キーバインド
(global-set-key (kbd "C-x C-j") 'nskk-mode)
```

### 設定の確認

```elisp
M-x nskk-version  ; バージョン確認
M-x nskk-check-environment  ; 環境チェック
```

## 基本機能テスト

### テストシナリオ1: ローマ字入力

**目的**: 基本的なローマ字→ひらがな変換の確認

**手順**:
1. `C-x C-j` でNSKKモードを有効化
2. 以下のローマ字を入力:
   - `aiueo` → あいうえお
   - `kakikukeko` → かきくけこ
   - `satou` → さとう
   - `konnnichiha` → こんにちは

**期待される結果**:
- 各入力が正しくひらがなに変換される
- キー入力のレスポンスが < 0.05ms (体感的に遅延なし)

**チェックリスト**:
- [ ] 基本的なローマ字変換が正しい
- [ ] 入力レスポンスに遅延がない
- [ ] 誤変換がない

### テストシナリオ2: 漢字変換

**目的**: 基本的な漢字変換と候補選択の確認

**手順**:
1. `nihon` と入力 → `にほん` になる
2. `SPC` を押して変換
3. 候補から選択:
   - `1`: 日本
   - `2`: 二本
   - `3`: (その他の候補)

**期待される結果**:
- 変換候補が正しく表示される
- 候補ウィンドウのレンダリングが < 0.5ms
- 選択がスムーズ

**チェックリスト**:
- [ ] 変換候補が表示される
- [ ] 適切な候補が上位に表示される
- [ ] 候補選択が正しく動作する
- [ ] 候補ウィンドウの表示が素早い

### テストシナリオ3: 送り仮名処理

**目的**: 動詞・形容詞の活用形の変換確認

**手順**:
1. `Ugok*u` → `動く` (動詞)
2. `Taka*i` → `高い` (形容詞)
3. `Oki*ta` → `起きた` (過去形)
4. `Tabe*ru` → `食べる` (下一段活用)

**期待される結果**:
- 送り仮名が正しく処理される
- 活用形が適切に変換される

**チェックリスト**:
- [ ] 五段活用動詞が正しい
- [ ] 一段活用動詞が正しい
- [ ] 形容詞が正しい
- [ ] 過去形・否定形などの活用が正しい

### テストシナリオ4: モード切り替え

**目的**: ひらがな/カタカナ/英数モードの切り替え確認

**手順**:
1. `C-x C-j` でNSKKモード有効化 (ひらがなモード)
2. `q` でカタカナモードに切り替え
3. `konpyu-ta` → `コンピュータ`
4. `l` で英数モードに切り替え
5. `emacs` → `emacs` (そのまま)
6. `C-j` でひらがなモードに戻る

**期待される結果**:
- 各モードが正しく切り替わる
- モードライン表示が更新される
- 切り替えに遅延がない

**チェックリスト**:
- [ ] ひらがなモードが動作
- [ ] カタカナモードが動作
- [ ] 英数モードが動作
- [ ] モードライン表示が正確

### テストシナリオ5: 特殊文字

**目的**: 促音、撥音、長音の処理確認

**手順**:
1. `kitte` → `きって` (促音)
2. `gakkou` → `がっこう` (促音 + 長音)
3. `onna` → `おんな` (撥音)
4. `sannpun` → `さんぷん` (撥音)
5. `ko-hi-` → `コーヒー` (カタカナモードで長音)

**期待される結果**:
- すべての特殊文字が正しく処理される

**チェックリスト**:
- [ ] 促音 (っ) が正しく入力できる
- [ ] 撥音 (ん) が正しく入力できる
- [ ] 長音 (ー) が正しく入力できる

## AI機能テスト

### テストシナリオ6: AI候補ランキング

**目的**: AI による文脈に基づいた候補順序の確認

**前提**: `(setopt nskk-use-ai-ranking t)` が有効

**手順**:
1. 以下の文章を入力:
   ```
   私は毎朝、[kうhi]を飲みます。
   ```
2. `kうhi` の変換候補を確認

**期待される結果**:
- 「コーヒー」が最上位候補になる (文脈から飲み物と推測)
- 「紅茶」「珈琲」なども候補に含まれる

**手順** (文脈変更):
1. 以下の文章を入力:
   ```
   この[kうhi]の名前は何ですか？
   ```
2. `kうhi` の変換候補を確認

**期待される結果**:
- 文脈に応じて候補順序が変わる

**チェックリスト**:
- [ ] 文脈に基づいた候補ランキングが動作
- [ ] 適切な候補が上位に表示される
- [ ] 候補順序が文脈によって変化する
- [ ] AI処理による遅延が < 2ms

### テストシナリオ7: 学習効果

**目的**: AI学習による候補順序の改善確認

**手順**:
1. 同じ文脈で何度も同じ単語を変換
2. 1日後、同じ単語を再度変換
3. 候補順序の変化を確認

**期待される結果**:
- 頻繁に選択する候補が上位に移動
- 文脈パターンが学習される

**チェックリスト**:
- [ ] 頻度学習が機能している
- [ ] 文脈学習が機能している
- [ ] 学習データが永続化されている

## 同期機能テスト

### テストシナリオ8: 辞書同期

**目的**: マルチデバイス間での辞書同期の確認

**前提**:
- 同期サーバーへのアクセス権
- `(setopt nskk-sync-enable t)` が有効

**手順** (デバイスA):
1. 新しい単語を個人辞書に追加
   ```elisp
   M-x nskk-dict-add-entry
   単語: てすと
   候補: テスト
   ```
2. 同期を実行
   ```elisp
   M-x nskk-sync-push
   ```

**手順** (デバイスB):
1. 同期を実行
   ```elisp
   M-x nskk-sync-pull
   ```
2. 追加した単語が存在することを確認

**期待される結果**:
- デバイス間で辞書が同期される
- 同期処理が < 5秒で完了 (差分同期)
- 暗号化通信が行われる

**チェックリスト**:
- [ ] 辞書の同期が正常に動作
- [ ] 差分同期が機能 (フル同期より高速)
- [ ] 暗号化が機能している
- [ ] 同期エラーが適切にハンドリングされる

### テストシナリオ9: 競合解決

**目的**: 同期競合の解決確認

**手順**:
1. デバイスAで単語「てすと」→「テスト1」を追加
2. デバイスBで単語「てすと」→「テスト2」を追加 (オフライン)
3. 両方で同期を実行
4. 競合解決UIが表示されることを確認
5. 適切な候補を選択

**期待される結果**:
- 競合が検出される
- ユーザーが選択できるUIが表示される
- 選択後、両デバイスで統一される

**チェックリスト**:
- [ ] 競合検出が機能
- [ ] 競合解決UIが表示される
- [ ] ユーザー選択が反映される
- [ ] 3-wayマージが正しく動作

## パフォーマンステスト

### テストシナリオ10: キー入力レスポンス

**目的**: キー入力の応答速度測定

**手順**:
1. プロファイラーを起動
   ```elisp
   M-x nskk-profiler-start
   ```
2. 高速タイピングで100文字以上入力
3. レポート生成
   ```elisp
   M-x nskk-profiler-report
   ```

**期待される結果**:
- キー入力応答時間: 平均 < 0.05ms
- 最大応答時間: < 0.1ms
- 体感的な遅延がない

**チェックリスト**:
- [ ] 平均応答時間 < 0.05ms
- [ ] 最大応答時間 < 0.1ms
- [ ] UIブロッキングが発生しない

### テストシナリオ11: 辞書検索速度

**目的**: 大規模辞書での検索速度確認

**前提**: SKK-JISYO.L (10万語以上) を使用

**手順**:
1. プロファイラーを起動
2. 様々な単語を変換 (50回以上)
3. 辞書検索時間を測定

**期待される結果**:
- 辞書検索時間: 平均 < 0.3ms
- キャッシュヒット時: < 0.01ms

**チェックリスト**:
- [ ] 辞書検索 < 0.3ms
- [ ] キャッシュが効果的に機能
- [ ] 大規模辞書でも高速

### テストシナリオ12: メモリ使用量

**目的**: メモリフットプリントの確認

**手順**:
1. Emacsを起動し、メモリ使用量を確認
2. NSKKを有効化
3. メモリ使用量の増加を測定
4. 長時間使用 (1時間以上)
5. メモリリークがないか確認

**期待される結果**:
- 初期メモリ使用量: < 20MB
- 長時間使用後も増加しない (リークなし)

**チェックリスト**:
- [ ] 初期メモリ < 20MB
- [ ] メモリリークがない
- [ ] GC頻度が適切 (< 1回/分)

### テストシナリオ13: 起動時間

**目的**: NSKK起動時間の測定

**手順**:
1. Emacsを起動
2. `C-x C-j` でNSKKを有効化
3. 起動時間を測定
   ```elisp
   M-x nskk-benchmark-startup
   ```

**期待される結果**:
- 起動時間 < 20ms
- 遅延読み込み (autoload) が機能

**チェックリスト**:
- [ ] 起動時間 < 20ms
- [ ] autoloadが機能
- [ ] 初回起動も高速

## プラグインテスト

### テストシナリオ14: プラグイン読み込み

**目的**: プラグインシステムの動作確認

**手順**:
1. サンプルプラグインを作成
   ```elisp
   ;; sample-plugin.el
   (require 'nskk-plugin-api)

   (nskk-plugin-register
    :name "sample"
    :version "0.1.0"
    :hooks '((nskk-before-convert . sample-plugin-hook)))

   (defun sample-plugin-hook (input)
     (message "Plugin called: %s" input))

   (provide 'sample-plugin)
   ```
2. プラグインを読み込み
   ```elisp
   M-x nskk-plugin-load
   File: sample-plugin.el
   ```
3. 変換を実行し、フックが呼ばれることを確認

**期待される結果**:
- プラグインが正常に読み込まれる
- フックが実行される
- サンドボックス内で安全に実行される

**チェックリスト**:
- [ ] プラグイン読み込みが成功
- [ ] フックが実行される
- [ ] サンドボックスが機能
- [ ] エラーハンドリングが適切

## フィードバックの提出

### 収集すべき情報

テスト完了後、以下の情報を収集してください:

1. **環境情報**
   ```elisp
   M-x nskk-report-environment
   ```

2. **パフォーマンスレポート**
   ```elisp
   M-x nskk-profiler-export-report
   ```

3. **ログファイル**
   - `~/.nskk/logs/debug.log`
   - エラーが発生した場合のスタックトレース

4. **スクリーンショット**
   - UI表示の問題があれば

### フィードバックフォーマット

```markdown
## テスト環境
- OS: [e.g., macOS 14.5]
- Emacs: [e.g., 31.0.50]
- NSKK: v0.9.0-beta
- 辞書: [e.g., SKK-JISYO.L 2025-10-01版]

## テスト期間
- 開始: YYYY-MM-DD
- 終了: YYYY-MM-DD
- 1日の平均使用時間: X時間

## 完了したテストシナリオ
- [x] シナリオ1: ローマ字入力
- [x] シナリオ2: 漢字変換
- [ ] シナリオ3: 送り仮名処理 (未テスト)
...

## 発見した問題
### 問題1: [タイトル]
- 重大度: [Critical/High/Medium/Low]
- 再現手順:
  1.
  2.
- 期待される動作:
- 実際の動作:
- エラーメッセージ:

## パフォーマンス測定結果
- キー入力応答: X ms
- 辞書検索: X ms
- メモリ使用: X MB
- 起動時間: X ms

## 良かった点


## 改善してほしい点


## 要望・提案


## 総合評価
[1-5点]

## 追加コメント


```

### 提出方法

1. **GitHub Issues**:
   - https://github.com/takeokunn/nskk.el/issues
   - Label: `beta-feedback`

2. **フィードバックフォーム**:
   - https://forms.gle/XXXXX (準備中)

3. **Email**:
   - bararararatty@gmail.com
   - Subject: [NSKK Beta] フィードバック

## テスト支援

### よくある質問

**Q: テスト中にEmacsがフリーズした場合は?**
A: `C-g` で中断を試みてください。それでも回復しない場合は、強制終了してログを保存し、バグレポートを提出してください。

**Q: パフォーマンステストの正確な測定方法は?**
A: `M-x nskk-profiler-start` を使用し、通常通り使用後に `M-x nskk-profiler-report` でレポートを生成してください。

**Q: 複数のバグを発見した場合は?**
A: 各バグごとに個別のGitHub Issueを作成してください。

**Q: プラグイン開発のサポートは?**
A: GitHub Discussionsで質問してください。

### サポート連絡先

- **GitHub Discussions**: https://github.com/takeokunn/nskk.el/discussions
- **Email**: bararararatty@gmail.com

## Thank You!

ベータテストへのご協力、ありがとうございます!

皆様の詳細なフィードバックが、NSKK v1.0の品質向上に不可欠です。
